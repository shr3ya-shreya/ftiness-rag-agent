# Fitness RAG Agent - Cursor IDE Setup Guide

A Retrieval-Augmented Generation (RAG) agent for fitness advice using FAISS vector database and sentence transformers, optimized for Cursor IDE.

## 🚀 Quick Start

### Prerequisites
- Python 3.8+
- Cursor IDE
- Git

### Installation

1. **Clone and setup the project:**
   ```bash
   git clone <your-repo-url>
   cd fitness-rag-agent
   ```

2. **Create virtual environment:**
   ```bash
   python -m venv venv
   # Windows:
   venv\Scripts\activate
   # macOS/Linux:
   source venv/bin/activate
   ```

3. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

4. **Run setup script:**
   ```bash
   python scripts/setup.py
   ```

### Running the Application

#### CLI Mode (Interactive)
```bash
python main.py cli
```

#### API Server Mode
```bash
python main.py api
```

#### Using Cursor IDE
1. Open the project in Cursor IDE
2. Press `F5` to start debugging
3. Select "Run CLI" or "Run API Server" from the debug menu
4. Use `Ctrl+Shift+P` → "Tasks: Run Task" for available tasks

## 📁 Project Structure

```
fitness-rag-agent/
├── .cursor/                    # Cursor IDE configuration
│   ├── settings.json          # Cursor workspace settings
│   ├── launch.json            # Debug configurations
│   └── tasks.json             # Build tasks
├── src/                       # Source code
│   ├── __init__.py
│   ├── rag_agent.py          # Main RAG agent class
│   ├── api_wrapper.py        # FastAPI wrapper + CLI
│   └── config.py             # Configuration settings
├── data/                      # Data files
│   └── sample_fitness_data.json
├── storage/                   # Auto-generated by agent
│   ├── fitness_index.faiss   # FAISS vector index
│   └── fitness_metadata.pkl  # Document metadata
├── tests/                     # Test files
│   ├── __init__.py
│   ├── test_agent.py         # Unit tests
│   └── test_api.py           # API tests
├── scripts/                   # Utility scripts
│   ├── setup.py              # Setup script
│   ├── run_cli.py            # CLI runner
│   └── run_api.py            # API server runner
├── .env                      # Environment variables
├── .gitignore               # Git ignore file
├── requirements.txt         # Python dependencies
├── main.py                  # Entry point
└── README.md               # This file
```

## 🔧 Cursor IDE Features

### Debug Configurations
- **Run CLI**: Start interactive command-line interface
- **Run API Server**: Start FastAPI server
- **Debug RAG Agent**: Debug the core agent functionality

### Tasks
- **Install Dependencies**: Install Python packages
- **Run Tests**: Execute test suite
- **Setup Project**: Initialize project structure
- **Create Virtual Environment**: Set up Python virtual environment

### Settings
- Python interpreter auto-detection
- Automatic virtual environment activation
- Code formatting and linting
- Test discovery and execution

## 🎯 Usage Examples

### CLI Usage
```bash
> query beginner squat advice
Based on your query: 'beginner squat advice'

Here's what I found:

1. **Squat for Beginner**
   Context: Personalization
   Advice: Start with box squats or bodyweight squats. Focus on consistent depth and control before adding load.
   Relevance: 0.856

> stats
Database Statistics:
  Total documents: 10
  Unique exercises: 10
  Unique contexts: 2
  Unique conditions: 5

> quit
Goodbye!
```

### API Usage
```bash
# Start API server
python main.py api

# Query via HTTP
curl -X POST "http://localhost:8000/query" \
     -H "Content-Type: application/json" \
     -d '{"query": "beginner squat advice", "k": 3}'

# Get statistics
curl -X GET "http://localhost:8000/stats"
```

## 🔌 API Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/query` | POST | Query the fitness agent |
| `/load_data` | POST | Load fitness data and create index |
| `/add_document` | POST | Add a new document to the index |
| `/stats` | GET | Get database statistics |
| `/health` | GET | Health check |

### Query Request Format
```json
{
  "query": "beginner squat advice",
  "k": 3
}
```

### Query Response Format
```json
{
  "query": "beginner squat advice",
  "results": [
    {
      "exercise": "squat",
      "context": "personalization",
      "condition": "beginner",
      "advice": "Start with box squats...",
      "similarity_score": 0.856,
      "rank": 1
    }
  ],
  "response": "Based on your query..."
}
```

## 🧪 Testing

Run the test suite:
```bash
# Run all tests
pytest tests/ -v

# Run specific test file
pytest tests/test_agent.py -v

# Run with coverage
pytest tests/ --cov=src
```

## ⚙️ Configuration

Environment variables in `.env`:
```env
MODEL_NAME=all-MiniLM-L6-v2
INDEX_FILE=storage/fitness_index.faiss
METADATA_FILE=storage/fitness_metadata.pkl
DATA_FILE=data/sample_fitness_data.json
API_HOST=0.0.0.0
API_PORT=8000
DEBUG=True
```

## 🔒 Security Features

- No sensitive data in frontend
- Environment variables properly handled
- Input validation on all API endpoints
- Error handling without information leakage
- Secure file handling for vector indices

## 🚀 Production Deployment

1. **Environment Setup:**
   ```bash
   export DEBUG=False
   export API_HOST=0.0.0.0
   export API_PORT=8000
   ```

2. **Run with Gunicorn:**
   ```bash
   pip install gunicorn
   gunicorn -w 4 -k uvicorn.workers.UvicornWorker src.api_wrapper:app
   ```

3. **Docker Deployment:**
   ```dockerfile
   FROM python:3.9-slim
   COPY . /app
   WORKDIR /app
   RUN pip install -r requirements.txt
   CMD ["python", "main.py", "api"]
   ```

## 🛠️ Development

### Adding New Data
1. Edit `data/sample_fitness_data.json`
2. Restart the application
3. The new data will be automatically indexed

### Customizing the Model
1. Change `MODEL_NAME` in `.env`
2. Delete existing index files in `storage/`
3. Restart the application

### Adding New Features
1. Create new methods in `FitnessRAGAgent`
2. Add corresponding API endpoints in `api_wrapper.py`
3. Write tests for new functionality
4. Update documentation

## 📚 Dependencies

- **faiss-cpu**: Vector similarity search
- **sentence-transformers**: Text embeddings
- **fastapi**: Web API framework
- **uvicorn**: ASGI server
- **pydantic**: Data validation
- **pytest**: Testing framework

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests
5. Submit a pull request

## 📄 License

This project is licensed under the MIT License.

## 🆘 Troubleshooting

### Common Issues

1. **Import Errors**: Ensure virtual environment is activated
2. **Module Not Found**: Check PYTHONPATH and ensure you're in project root
3. **Permission Errors**: Check file permissions in storage/ directory
4. **Port Already in Use**: Change port in config.py or kill existing processes

### Debug Tips

1. Use Cursor debugger (F5) to step through code
2. Check Python interpreter in Cursor (bottom-left)
3. View output in Cursor terminal
4. Use "Python: Select Interpreter" to choose correct venv

## 📞 Support

For issues and questions:
1. Check the troubleshooting section
2. Review the test cases
3. Open an issue on GitHub
4. Check the API documentation at `http://localhost:8000/docs` when running
